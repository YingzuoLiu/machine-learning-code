<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ConvE模型图解演示</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            margin: 0;
            padding: 20px;
            color: white;
        }
        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.3);
        }
        h1 {
            text-align: center;
            font-size: 2.5em;
            margin-bottom: 30px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }
        .step-container {
            margin: 40px 0;
            padding: 30px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 15px;
            border-left: 5px solid #FFD700;
        }
        .step-title {
            font-size: 1.8em;
            font-weight: bold;
            margin-bottom: 20px;
            color: #FFD700;
        }
        .visual-area {
            display: flex;
            justify-content: center;
            align-items: center;
            margin: 20px 0;
            min-height: 200px;
        }
        .embedding-box {
            background: linear-gradient(45deg, #FF6B6B, #FF8E53);
            padding: 15px;
            margin: 10px;
            border-radius: 10px;
            text-align: center;
            font-weight: bold;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
            transition: all 0.3s ease;
        }
        .embedding-box:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.4);
        }
        .vector {
            display: flex;
            flex-direction: column;
            gap: 3px;
        }
        .vector-element {
            background: #4ECDC4;
            padding: 5px 10px;
            border-radius: 5px;
            font-size: 0.9em;
            text-align: center;
        }
        .matrix-2d {
            display: grid;
            gap: 3px;
            background: #45B7D1;
            padding: 15px;
            border-radius: 10px;
            margin: 10px;
        }
        .matrix-cell {
            background: #96CEB4;
            padding: 8px;
            border-radius: 3px;
            text-align: center;
            font-size: 0.8em;
            font-weight: bold;
        }
        .conv-filter {
            background: linear-gradient(45deg, #A8E6CF, #88D8C0);
            padding: 10px;
            border-radius: 8px;
            margin: 5px;
            text-align: center;
            font-size: 0.9em;
            font-weight: bold;
        }
        .arrow {
            font-size: 2em;
            color: #FFD700;
            margin: 0 20px;
            animation: pulse 2s infinite;
        }
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.6; }
        }
        .output-scores {
            background: linear-gradient(45deg, #FFA726, #FF7043);
            padding: 20px;
            border-radius: 15px;
            text-align: center;
            max-width: 400px;
        }
        .score-item {
            background: rgba(255,255,255,0.9);
            color: #333;
            padding: 8px 15px;
            margin: 5px;
            border-radius: 20px;
            font-weight: bold;
        }
        .interactive-btn {
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 25px;
            font-size: 1.1em;
            font-weight: bold;
            cursor: pointer;
            margin: 10px;
            transition: all 0.3s ease;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
        }
        .interactive-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(0,0,0,0.4);
        }
        .explanation {
            background: rgba(255,255,255,0.1);
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
            border-left: 4px solid #4ECDC4;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>🧠 ConvE模型完整工作流程图解</h1>
        
        <!-- 步骤1：输入嵌入 -->
        <div class="step-container">
            <div class="step-title">步骤1：输入嵌入向量</div>
            <div class="explanation">
                <p><strong>示例三元组：</strong> (Barack_Obama, nationality, USA)</p>
                <p>我们有头实体 <strong>h</strong> (Barack_Obama) 和关系 <strong>r</strong> (nationality)，要预测尾实体 <strong>t</strong></p>
            </div>
            <div class="visual-area">
                <div class="embedding-box">
                    <div>头实体 h (Barack_Obama)</div>
                    <div class="vector">
                        <div class="vector-element">0.2</div>
                        <div class="vector-element">-0.1</div>
                        <div class="vector-element">0.8</div>
                        <div class="vector-element">...</div>
                        <div class="vector-element">0.3</div>
                    </div>
                    <div>维度: d=200</div>
                </div>
                
                <div class="arrow">+</div>
                
                <div class="embedding-box">
                    <div>关系 r (nationality)</div>
                    <div class="vector">
                        <div class="vector-element">0.5</div>
                        <div class="vector-element">0.7</div>
                        <div class="vector-element">-0.3</div>
                        <div class="vector-element">...</div>
                        <div class="vector-element">0.1</div>
                    </div>
                    <div>维度: d=200</div>
                </div>
            </div>
        </div>

        <!-- 步骤2：拼接与重塑 -->
        <div class="step-container">
            <div class="step-title">步骤2：拼接并重塑为2D矩阵</div>
            <div class="explanation">
                <p><strong>关键创新：</strong>ConvE将1D向量重塑为2D矩阵，这样可以使用2D卷积!</p>
                <p>拼接后的向量 [h; r] 维度为 2d=400，重塑为 20×20 的2D矩阵</p>
            </div>
            <div class="visual-area">
                <div class="embedding-box">
                    <div>拼接向量 [h; r]</div>
                    <div class="vector">
                        <div class="vector-element">h₁, h₂, ..., h₂₀₀</div>
                        <div class="vector-element">r₁, r₂, ..., r₂₀₀</div>
                    </div>
                    <div>总维度: 2d=400</div>
                </div>
                
                <div class="arrow">→</div>
                
                <div class="matrix-2d" style="grid-template-columns: repeat(4, 1fr);" id="reshapedMatrix">
                    <!-- 动态生成矩阵内容 -->
                </div>
                
                <button class="interactive-btn" onclick="animateReshape()">🔄 演示重塑过程</button>
            </div>
        </div>

        <!-- 步骤3：2D卷积操作 -->
        <div class="step-container">
            <div class="step-title">步骤3：2D卷积操作</div>
            <div class="explanation">
                <p><strong>卷积的作用：</strong>提取局部特征模式，捕获头实体和关系之间的复杂交互</p>
                <p>使用多个卷积核（如3×3大小）在2D矩阵上滑动，产生特征图</p>
            </div>
            <div class="visual-area">
                <div class="embedding-box">
                    <div>输入2D矩阵</div>
                    <div class="matrix-2d" style="grid-template-columns: repeat(3, 1fr);">
                        <div class="matrix-cell">h₁</div><div class="matrix-cell">h₂</div><div class="matrix-cell">h₃</div>
                        <div class="matrix-cell">h₄</div><div class="matrix-cell">h₅</div><div class="matrix-cell">h₆</div>
                        <div class="matrix-cell">r₁</div><div class="matrix-cell">r₂</div><div class="matrix-cell">r₃</div>
                    </div>
                </div>
                
                <div class="arrow">*</div>
                
                <div class="embedding-box">
                    <div>卷积核</div>
                    <div class="matrix-2d" style="grid-template-columns: repeat(3, 1fr);">
                        <div class="conv-filter">w₁</div><div class="conv-filter">w₂</div><div class="conv-filter">w₃</div>
                        <div class="conv-filter">w₄</div><div class="conv-filter">w₅</div><div class="conv-filter">w₆</div>
                        <div class="conv-filter">w₇</div><div class="conv-filter">w₈</div><div class="conv-filter">w₉</div>
                    </div>
                    <div style="margin-top: 10px;">多个滤波器</div>
                </div>
                
                <div class="arrow">→</div>
                
                <div class="embedding-box">
                    <div>特征图</div>
                    <div class="matrix-2d" style="grid-template-columns: repeat(2, 1fr);" id="featureMap">
                        <div class="matrix-cell">f₁</div><div class="matrix-cell">f₂</div>
                        <div class="matrix-cell">f₃</div><div class="matrix-cell">f₄</div>
                    </div>
                </div>
            </div>
            <button class="interactive-btn" onclick="animateConvolution()">🎯 演示卷积过程</button>
        </div>

        <!-- 步骤4：展平与全连接 -->
        <div class="step-container">
            <div class="step-title">步骤4：展平与全连接层</div>
            <div class="explanation">
                <p><strong>处理流程：</strong>将卷积后的特征图展平，通过全连接层得到最终表示</p>
                <p>这个表示将用于与所有候选实体计算相似度得分</p>
            </div>
            <div class="visual-area">
                <div class="embedding-box">
                    <div>卷积特征图</div>
                    <div class="matrix-2d" style="grid-template-columns: repeat(4, 1fr);">
                        <div class="matrix-cell">f₁</div><div class="matrix-cell">f₂</div><div class="matrix-cell">f₃</div><div class="matrix-cell">f₄</div>
                        <div class="matrix-cell">f₅</div><div class="matrix-cell">f₆</div><div class="matrix-cell">f₇</div><div class="matrix-cell">f₈</div>
                    </div>
                </div>
                
                <div class="arrow">→</div>
                
                <div class="embedding-box">
                    <div>展平向量</div>
                    <div class="vector">
                        <div class="vector-element">f₁</div>
                        <div class="vector-element">f₂</div>
                        <div class="vector-element">f₃</div>
                        <div class="vector-element">...</div>
                        <div class="vector-element">f₈</div>
                    </div>
                </div>
                
                <div class="arrow">→</div>
                
                <div class="embedding-box">
                    <div>全连接层输出</div>
                    <div class="vector">
                        <div class="vector-element" style="background: #FF6B6B;">o₁</div>
                        <div class="vector-element" style="background: #FF6B6B;">o₂</div>
                        <div class="vector-element" style="background: #FF6B6B;">...</div>
                        <div class="vector-element" style="background: #FF6B6B;">o₂₀₀</div>
                    </div>
                    <div>最终表示向量</div>
                </div>
            </div>
        </div>

        <!-- 步骤5：计算得分 -->
        <div class="step-container">
            <div class="step-title">步骤5：与候选实体计算得分</div>
            <div class="explanation">
                <p><strong>得分计算：</strong>将ConvE输出与所有实体嵌入计算点积，得到每个实体作为尾实体的得分</p>
                <p>得分越高，表示该实体越可能是正确答案</p>
            </div>
            <div class="visual-area">
                <div class="embedding-box">
                    <div>ConvE输出</div>
                    <div class="vector">
                        <div class="vector-element" style="background: #FF6B6B;">[0.8, 0.2, ...]</div>
                    </div>
                </div>
                
                <div class="arrow">×</div>
                
                <div class="embedding-box">
                    <div>所有实体嵌入</div>
                    <div>
                        <div class="vector-element" style="background: #4ECDC4;">USA: [0.9, 0.1, ...]</div>
                        <div class="vector-element" style="background: #4ECDC4;">China: [0.2, 0.8, ...]</div>
                        <div class="vector-element" style="background: #4ECDC4;">France: [0.3, 0.7, ...]</div>
                        <div class="vector-element" style="background: #4ECDC4;">...</div>
                    </div>
                </div>
                
                <div class="arrow">→</div>
                
                <div class="output-scores">
                    <div>预测得分</div>
                    <div class="score-item" style="background: #4CAF50; color: white;">🇺🇸 USA: 0.95</div>
                    <div class="score-item">🇨🇳 China: 0.23</div>
                    <div class="score-item">🇫🇷 France: 0.18</div>
                    <div class="score-item">🇬🇧 UK: 0.15</div>
                    <div style="margin-top: 15px; font-weight: bold;">✅ 预测结果：USA</div>
                </div>
            </div>
            <button class="interactive-btn" onclick="animateScoring()">🎯 演示得分计算</button>
        </div>

        <!-- ConvE优势 -->
        <div class="step-container">
            <div class="step-title">🌟 ConvE的核心优势</div>
            <div class="explanation">
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-top: 20px;">
                    <div style="background: rgba(76, 175, 80, 0.2); padding: 15px; border-radius: 10px;">
                        <h3>🚀 效率优势</h3>
                        <p>• 2D卷积参数比全连接层少</p>
                        <p>• 支持批量并行计算</p>
                        <p>• 训练速度快</p>
                    </div>
                    <div style="background: rgba(63, 81, 181, 0.2); padding: 15px; border-radius: 10px;">
                        <h3>🎯 表达能力</h3>
                        <p>• 捕获局部交互模式</p>
                        <p>• 2D结构提供新的归纳偏置</p>
                        <p>• 在多数据集上达到SOTA</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        function animateReshape() {
            const matrix = document.getElementById('reshapedMatrix');
            matrix.innerHTML = '';
            matrix.style.gridTemplateColumns = 'repeat(5, 1fr)';
            
            const elements = ['h₁', 'h₂', 'h₃', 'h₄', 'h₅', 'h₆', 'h₇', 'h₈', 'h₉', 'h₁₀', 'r₁', 'r₂', 'r₃', 'r₄', 'r₅', 'r₆', 'r₇', 'r₈', 'r₉', 'r₁₀'];
            
            elements.forEach((el, i) => {
                setTimeout(() => {
                    const cell = document.createElement('div');
                    cell.className = 'matrix-cell';
                    cell.textContent = el;
                    cell.style.opacity = '0';
                    cell.style.transform = 'scale(0)';
                    matrix.appendChild(cell);
                    
                    setTimeout(() => {
                        cell.style.transition = 'all 0.3s ease';
                        cell.style.opacity = '1';
                        cell.style.transform = 'scale(1)';
                    }, 50);
                }, i * 100);
            });
        }

        function animateConvolution() {
            const featureMap = document.getElementById('featureMap');
            const cells = featureMap.querySelectorAll('.matrix-cell');
            
            cells.forEach((cell, i) => {
                setTimeout(() => {
                    cell.style.transition = 'all 0.5s ease';
                    cell.style.background = '#FFD700';
                    cell.style.transform = 'scale(1.2)';
                    
                    setTimeout(() => {
                        cell.style.background = '#96CEB4';
                        cell.style.transform = 'scale(1)';
                    }, 300);
                }, i * 200);
            });
        }

        function animateScoring() {
            const scores = document.querySelectorAll('.score-item');
            scores.forEach((score, i) => {
                setTimeout(() => {
                    score.style.transition = 'all 0.5s ease';
                    score.style.transform = 'scale(1.1)';
                    score.style.boxShadow = '0 5px 15px rgba(0,0,0,0.3)';
                    
                    setTimeout(() => {
                        score.style.transform = 'scale(1)';
                        score.style.boxShadow = 'none';
                    }, 400);
                }, i * 150);
            });
        }

        // 初始化矩阵显示
        window.onload = function() {
            animateReshape();
        }
    </script>
</body>
</html>