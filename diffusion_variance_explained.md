
# 📘 为什么扩散模型里要有 √(1−β_t) 和 √(β_t)

---

## 一、方差演化推导（数学支撑）

### 1. 如果没有缩放

假设：

x_t = x_{t-1} + √(β_t) ε_t,   ε_t ∼ N(0, I)

则方差递推为：

Var[x_t] = Var[x_{t-1}] + β_t.

展开后：

Var[x_t] = Var[x_0] + ∑_{s=1}^t β_s.

→ 方差会 **线性累积**，越走越大，最终爆炸。

---

### 2. 如果加上缩放

改成：

x_t = √(1−β_t) x_{t-1} + √(β_t) ε_t.

此时：

Var[x_t] = (1−β_t) Var[x_{t-1}] + β_t.

解这个递推式，得到：

Var[x_t] = ᾱ_t Var[x_0] + (1−ᾱ_t),

其中 ᾱ_t = ∏_{s=1}^t (1−β_s)。

当 t → ∞， ᾱ_t → 0，所以：

lim_{t→∞} Var[x_t] = 1.

✅ 这样保证了过程最终收敛到 N(0,I)，数值稳定。

---

## 二、为什么是「根号」形式？

核心原因是：

- 我们往往希望控制 **方差 = β_t**。
- 但在公式里我们实际加的是 **标准差**，也就是 √(β_t)。
- 所以系数自然带了根号。

这就是为什么在扩散模型的公式里看到 √(1−β_t) 和 √(β_t)。

---

## 三、常见出现「根号」的场景

这种「开根号」不仅在扩散模型里有，在很多机器学习与统计里都出现过：

| 场景 | 公式 | 根号出现原因 |
| --- | --- | --- |
| **扩散模型** | x_t = √(1−β_t) x_{t-1} + √(β_t) ε | 保证方差稳定收敛到 1 |
| **VAE 重参数化** | z = μ + σ ε | 采样 N(μ,σ²I)，标准差是方差开根号 |
| **深度学习初始化** | W ∼ U(−√k, √k) | 控制权重初始方差稳定 |
| **布朗运动 / 随机游走** | x_{t+Δt} = x_t + √(Δt) ε | 方差与时间成正比，标准差是 √(Δt) |
| **蒙特卡罗估计** | StdError = σ / √n | 样本均值的标准差随样本数缩放 |

---

## 四、总结（举一反三的直觉）

- **方差加法**：如果你希望“方差累加到目标值”，就需要在噪声项前面放一个「标准差」系数，即方差的平方根。
- **缩小前一状态**：如果你希望过程不发散（方差稳定），就需要对前一状态乘上 √(1−β_t)。
- **通用规律**：凡是涉及「控制分布的尺度」的问题，根号几乎都会出现，因为真正控制的是标准差，而不是方差。

---

👉 换句话说：**根号就是在“告诉系统：我控制的是标准差”**
