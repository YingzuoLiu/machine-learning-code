# 📌 广告策略总结

## 0. 名词解释
- **pCTR (predicted Click Through Rate)**：预测点击率，表示某用户在当前场景下点击广告的概率。  
- **pCVR (predicted Conversion Rate)**：预测转化率，表示用户点击广告后完成转化（购买/注册/下载）的概率。  
- **Bid(CPC)**：广告主愿意为一次点击支付的价格（按点击计费）。  
- **Bid(CPA)**：广告主愿意为一次转化支付的价格（按转化计费）。  
- **eCPM (effective Cost per Mille)**：每千次展示的预期收益，作为广告排序和竞价的统一指标。  
  - CPC 模式：  
    \[
    eCPM = pCTR \times Bid(CPC) \times 1000
    \]  
  - CPA 模式：  
    \[
    eCPM = pCTR \times pCVR \times Bid(CPA) \times 1000
    \]  

---

## 1. 预算 Pacing（投放节奏控制）
**目标**：控制广告消耗速度，使预算在设定周期内合理花费。  

**落地方式**：  
1. **流量预测**：预测每天/每小时的请求量和 CTR 趋势。  
2. **预算曲线设计**：设定目标消耗曲线，例如  
   \[
   TargetSpend(t) = Budget \times \frac{t}{T}
   \]  
3. **实时调控**：  
   - 若实际消耗 < 目标 → 放宽出价，提高曝光。  
   - 若实际消耗 > 目标 → 收紧出价，降低曝光。  
4. **实现机制**：  
   - 在 **RTB 出价环节**，乘以 pacing multiplier。  
   - 可用 **PID 控制器 / RL agent** 动态调节。  

---

## 2. 出价调整（Bid Adjustment）
**目标**：在广告主的 BaseBid 基础上，根据不同用户与场景动态修正。  

**落地方式**：  
1. **上下文修正因子**：设备、地域、时段、用户分群。  
   \[
   Bid = BaseBid \times f(device) \times f(region) \times f(time) \times f(user)
   \]  
2. **个性化调整**：结合 pCTR/pCVR 预测，若 ROI 较高 → 提高出价。  
3. **学习优化**：通过 **多臂 Bandit / RL** 探索最优调节因子。  

---

## 3. 智能竞价（Smart Bidding）
**目标**：自动出价，帮助广告主实现 ROI 目标（如 Target CPA、Target ROAS）。  

**落地方式**：  
1. **统一 eCPM 排序指标**  
2. **约束优化**：  
   - Target CPA：控制平均转化成本 ≈ 目标值。  
   - Target ROAS：优化收益 / 广告花费。  
3. **算法实现**：  
   - 多臂 Bandit：探索不同出价区间的效果。  
   - 强化学习：状态 = 预算进度 + 流量情况，动作 = 出价倍率，奖励 = ROI/转化。  

---

## 4. 平台可控 vs 广告主可控

| 维度 | 广告主可控 | 平台可控 |
|------|-------------|-------------|
| **预算** | 日预算 / 总预算 | 投放节奏 pacing（消耗速度） |
| **出价** | BaseBid (CPC/CPA) | 有效出价调节（multiplier / OCPC） |
| **付费模式** | CPC / CPA / CPM | 转换为统一 eCPM 排序 |
| **素材** | 文案、图片、视频 | 素材审核、质量分层、冷启动流量保护 |
| **效果指标** | 目标 CPA / ROAS | pCTR / pCVR 预测模型 |
| **流量分配** | 不可控 | 曝光机会分配、多样性控制、冷启动扶持 |
| **目标函数** | ROI 最大化 | 收入最大化 + ROI 平衡 + 用户体验 |

---

## 5. 广告投放系统整体流程图

```mermaid
flowchart LR
    A[广告主设定<br/>预算/出价/模式/素材] --> B[平台接收请求 RTB]
    B --> C[预算 Pacing<br/>(消耗节奏控制)]
    C --> D[出价调整<br/>(用户/上下文因子)]
    D --> E[智能竞价<br/>(pCTR/pCVR → eCPM)]
    E --> F[广告排序与拍卖]
    F --> G[广告展示给用户]
    G --> H[用户反馈<br/>点击/转化数据]
    H --> I[模型更新与策略优化]
    I --> C
